# 用户手册 (带*为管理员手册额外部分)

## 1. 硬件信息与环境版本声明

惠普G6* 2：

CPU：10700  

GPU： 1660super

Disk： 256SSD+1THDD



*Ubuntu 20.04 LTS (Focal Fossa) Desktop image x86_64
*Docker image: Ubuntu 20.04 LTS



root用户信息：

```shell
usr：root 
pwd：215a215b
```
*硬盘分区：sd0 为SSD，sda1为HDD

| 挂载  | 分区类型 | 大小        | 格式 | 说明                  |
| ----- | -------- | ----------- | ---- | --------------------- |
| /     | 主分区   | 200G (sda0) | ext4 | 根目录，存放系统 软件 |
| Swap  | 逻辑分区 | 32G（sda0） | swap | 虚拟内存。            |
| /boot | 逻辑分区 | 4G（sda0）  | ext4 | 引导分区，例如 grub   |
| /home | 逻辑分区 | 1T （sda1） | ext4 | 存放用户信息和数据    |

*换源

```shell
sudo cp /etc/apt/sources.list /etc/apt/sources.list.bcakup
#备份源
sudo vim /etc/apt/sources.list
#加入清华源。 用以下内容替换原文件内容
#----------------------------------------------------------------------------------------
# 默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse

deb http://security.ubuntu.com/ubuntu/ focal-security main restricted universe multiverse
# deb-src http://security.ubuntu.com/ubuntu/ focal-security main restricted universe multiverse

# 预发布软件源，不建议启用
# deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse
# # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse
#------------------------------------------------------------------------------------------------
sudo apt-get update
sudo apt-get upgrade
# 更新
```

以下环境/服务在docker容器内配置：

*Cuda：

*SSH服务：

*Git：

*Ftp：

*Anaconda：

## 2. Docker

### （1） 基本概念：

​	什么是 Docker：虚拟技术，类似Virtual Machines，区别在于 Virtual Machines 模拟一套硬件，在其运行一套完整操作系统，Docker 寄宿于宿主（host）内核，仅包含applications 和 dependences（环境），更为轻便。

- 镜像（`Image`）

  相当于root文件。对于Linux，操作系统启动后，内核会挂载root文件供使用。 镜像包含 程序，库，环境变量，用户等数据。例如Alice发布一个镜像包含了 linux系统，anaconda等程序供他人下载使用。

- 容器`（Container`）

  镜像是静态。容器是动态，是运行的镜像，实质是一个进程。 容器有单独的命名空间，用户配置，其在隔离环境下运行，不会影响宿主。

  tips：文件的读写操作，最好绑定宿主文件，跳过容器的存储层。容器消亡，数据不会丢失。

- 仓库（`Repository`）

  镜像在宿主机构建完成后，需要对外发布，在其它主机上使用这个镜像。仓库有着 集中存储，分发镜像 的功能。

### *（2）  安装Docker： 

首先卸载旧的Docker（如有）：

```shell
$ sudo apt-get remove docker \
               docker-engine \
               docker.io
```


​	以Ubuntu LTS 版 为例。

第一步：更新APT，安装curl和CA证书

```shell
$ sudo apt-get update

$ sudo apt-get install \
    apt-transport-https \
    ca-certificates \
    curl \
    gnupg \
    lsb-release
```

第二步：使用脚本自动安装，使用阿里云镜像，如已配置系统代理，去掉--mirror Aliyun。 

```Shell
$ curl -fsSL get.docker.com -o get-docker.sh
$ sudo sh get-docker.sh --mirror Aliyun
```
### （3） 启动Docker：

```shell
$ sudo systemctl enable docker
$ sudo systemctl start docker
```

测试是否正确安装启动：

```shell
$ docker run --rm hello-world
```

若显示以下信息，则成功：

Hello from Docker!

This message shows that your installation appears to be working correctly.

### *（4） 配置Docker加速 

国内访问较慢，配置加速器。

在`/etc/docker/daemon.json` 中写入如下内容（如果文件不存在请新建该文件）：

```json
{
  "registry-mirrors": [
  	"https://docker.mirrors.ustc.edu.cn/",
    "https://hub-mirror.c.163.com",
    "https://mirror.baidubce.com"
  ]
}
```

之后重启docker：

```shell
$ sudo systemctl daemon-reload
$ sudo systemctl restart docker
```

检查是否生效：

```shell
$ docker info
```

显示上述镜像源，则成功。

### （5）基础镜像操作

管理员从Docker hub中获取镜像，配置环境。

用户使用本地镜像。

从Docker hub 获取：

```shell
$ docker pull [OPTIONS] NAME[:TAG|@DIGEST]
```

例如，以下命令从默认hub获取 ubuntu 20.04

```shell
$ docker pull ubuntu:20.04
```



使用本地镜像：

```shell
$ docker load < xxx.tar
```

查看镜像：

```shell
$ docker images
```

删除镜像：

```shell
$ docker image rm  <镜像1>
```

可以是镜像名，ID，等

### （6）容器操作

启动：

```shell
$ docker run --name [容器名] -it [镜像名] /bin/bash
```

-it： -i 交互操作，-t 终端。 此参数为 交互式终端

bash： 命令，运行容器后自动打开bash

终止：

```shell
$ docker container stop [名字]
```

进入一个容器：

```shell
$ docker attach
```

删除：

```shell
$ docker container rm [名字]
```

导出容器快照： 

```shell
$ docker export [容器ID] > xxx.tar
```

导入容器快照：

```shell
$ docker import [路径] [新名字]
```

不推荐用快照导入导出，因为快照丢弃所有的历史记录和数据信息，仅保存当前状态。 优势是快。

### （7） 数据存储

Docker的数据会随着容器消亡而消亡，若需要持久化数据，则需要数据卷（Volume）或者存储在宿主目录。

数据卷： 不同容器共享，生命周期不随着容器变化。持久层。

```shell
$ docker volume create my-vol
# 创建
$ docker volume ls
#查看
$ docker volume rm my-vol
#删除
```

启动一个挂载数据卷的容器：

```shell
$ docker run -it -v <volume name>:<path in container挂载到容器目录的路径> <image name>
```

例如，将数据卷my-vol挂载到容器myimaga的/app/data 目录：

```shell
$ docker run -it -v my-vol：/app/data myimage
```



挂载一个主机本地文件作为数据卷(推荐)：

```shell
$ docker run -it -v <volume name>:/<path in container> -v <host-path>:/<path on host> <image-name>
```

### *（8）打包配置好的镜像

```shell
$ docker save -o <打包名>.tar <待打包镜像名>:<版本 例如 V1.0>
```

## 3. Kernel层
-  实现多个基础运算. 例如 RSA  AES FHE mod运算,快速傅里叶变换等.
- 不同进程 容器间的通信,IO,广播等功能函数实现.
- 以MPSPDZ为基础, 实现函数转电路, $\mathbb {F}$ 下Shamir ,加法 ,复制秘密分享. $\mathbb{Z}_{2^k}$ 下的加法,复制秘密分享. 基础OT操作. 

## 4. Protocols层   

- 复现经典论文协议 ,例如ABY3 .

## 5.  Service 层

- 机器学习隐私保护
- 联邦学习
- lightweight 边缘计算

## 6. 日志记录 

任何修改都需记录在此节。


------
```shell
# 2023.12.11 张建栋new了文档1.0
```
------

